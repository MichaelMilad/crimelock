{
  "equations": {
    "RatePerMille": {
      "temp": true,
      "expression": "PRODUCT(DIVIDE(limit, 1000), 1.5)"
    },

    "BasicLoad": {
      "temp": true,
      "expression": "PRODUCT(vl_EmployeeLoad, vl_ClassALoad, industryLoad, vl_RevenueLoad)"
    },
    "RevenueLoadID": {
      "temp": true,
      "expression": "ROUND(DIVIDE(currentRevenue, 1000000))"
    },

    "FinalLoadOnPremium": {
      "temp": true,
      "expression": "vl_LoadOnPremium",
      "conditionalCases": [
        {
          "condition": "fullPriorActsCoverage",
          "expression": "PRODUCT(vl_LoadOnPremium, vl_fullPriorActsCoverageFactor)"
        }
      ]
    },

    "Premium_temp": {
      "temp": true,
      "expression": "ROUND(PRODUCT(eq_BasicLoad, vl_LimitLoad, vl_RetentionLoad))"
    },
    "Premium_temp2": {
      "temp": true,
      "expression": "eq_Premium_temp",
      "conditionalCases": [
        {
          "condition": "AND(SMALLER(eq_Premium_temp, eq_RatePerMille), GREATER_OR_EQUAL(eq_RatePerMille, vl_MinPremium))",
          "expression": "eq_RatePerMille"
        },
        {
          "condition": "AND(SMALLER(eq_Premium_temp, vl_MinPremium), SMALLER_OR_EQUAL(eq_RatePerMille, vl_MinPremium))",
          "expression": "vl_MinPremium"
        }
      ]
    },
    "premium": {
      "expression": "ROUND(PRODUCT(eq_Premium_temp2, proRateFactor, eq_FinalLoadOnPremium))"
    }
  },

  "lookups": {
    "EmployeeLoad": {
      "temp": true,
      "query": {
        "table": "crimelock_emp_load",
        "target": "EmployeeLoad",
        "where": {
          "eq": ["EmployeeID", "@numberOfEmployees"]
        }
      },
      "conditionalCases": [
        {
          "condition": "GREATER(numberOfEmployees, 1000)",
          "query": {
            "table": "crimelock_emp_load",
            "target": "EmployeeLoad",
            "where": {
              "eq": ["EmployeeID", "1000"]
            }
          }
        }
      ]
    },

    "RevenueLoad": {
      "temp": true,
      "query": {
        "table": "crimelock_rev_load",
        "target": "RevenueLoad",
        "where": {
          "eq": ["RevenueID", "@eq_RevenueLoadID"]
        }
      },
      "conditionalCases": [
        {
          "condition": "SMALLER(currentRevenue, 1000000)",
          "value": 1
        }
      ]
    },

    "RetentionLoad": {
      "temp": true,
      "query": {
        "table": "crimelock_retention_load",
        "target": "RetentionLoad",
        "where": {
          "and": [
            { "gte": ["RetentionIDTo", "@retention"] },
            { "lt": ["RetentionIDFrom", "@retention"] }
          ]
        }
      }
    },

    "LimitLoad": {
      "temp": true,
      "query": {
        "table": "crimelock_limit_load",
        "target": "limitLoad",
        "where": {
          "and": [
            { "gte": ["limitIdTo", "@limit"] },
            { "lt": ["limitIdFrom", "@limit"] }
          ]
        }
      }
    },

    "MinPremium": {
      "temp": true,
      "value": 2160
    },
    "ClassALoad": {
      "temp": true,
      "value": 0.943424083457335
    },
    "fullPriorActsCoverageFactor": {
      "temp": true,
      "value": 1.1
    },
    "LoadOnPremium": {
      "temp": true,
      "value": 1.44
    }
  },

  "schemaValidation": {
    "type": "object",
    "required": [
      "numberOfEmployees",
      "currentRevenue",
      "industryLoad",
      "limit",
      "retention",
      "proRateFactor"
    ],
    "properties": {
      "numberOfEmployees": {
        "type": "number"
      },
      "currentRevenue": {
        "type": "number"
      },
      "industryLoad": {
        "type": "number",
        "minimum": 1
      },
      "retention": {
        "type": "number"
      },
      "limit": {
        "type": "number",
        "minimum": 500000,
        "maximum": 3000000
      },
      "proRateFactor": {
        "type": "number",
        "minimum": 0.45,
        "maximum": 1.6
      },
      "fullPriorActsCoverage": {
        "type": "boolean",
        "default": false
      }
    }
  },

  "queryCriteria": {
    "name": "crimelock_rater"
  }
}
